<div class="w-full max-w-[1300px] mx-auto">
  <!-- HEADER -->
  <div class="mb-6 text-center">
    <h2 class="text-2xl font-black text-[#4B3621]">INVENTARIO</h2>
    <p class="text-sm text-[#6E5C4B]">
      ¡Crea, actualiza, activa o desactiva tus productos aquí!
    </p>
  </div>

  <!-- CREAR PRODUCTO -->
  <div class="mb-6 p-4 rounded-2xl border bg-white/80 border-[#4B3621]/10">
    <h3 class="font-bold text-[#4B3621] mb-3">Crear producto</h3>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
      <input
        type="text"
        placeholder="Nombre"
        class="h-12 px-4 rounded-xl border border-[#8B6F47]/40"
        [(ngModel)]="newName"
      />

      <input
        type="number"
        placeholder="Precio"
        class="h-12 px-4 rounded-xl border border-[#8B6F47]/40"
        [(ngModel)]="newPrice"
      />

      <input
        type="number"
        placeholder="Stock"
        class="h-12 px-4 rounded-xl border border-[#8B6F47]/40"
        [(ngModel)]="newStock"
      />
    </div>

    <button
      (click)="createProduct()"
      class="mt-3 h-12 px-6 rounded-xl bg-[#4B3621] text-[#F5F5DC] font-bold"
    >
      Crear
    </button>

    @if (createMsg) {
      <p class="text-sm mt-2 text-[#6E5C4B]">{{ createMsg }}</p>
    }
  </div>

  <!-- LISTA PRODUCTOS -->
  @if (loading) {
    <p>Cargando...</p>
  } @else if (errorMsg) {
    <p>{{ errorMsg }}</p>
  } @else {
    @for (p of products; track p.id) {
      <div
        class="mb-4 p-4 rounded-2xl border bg-white border-[#4B3621]/10 flex justify-between items-center"
      >
        <div>
          <p class="font-bold text-[#4B3621]">{{ p.name }}</p>
          <p class="text-sm text-[#6E5C4B]">
            Precio: ${{ p.price }} | Stock: {{ p.stock }}
          </p>
          <p
            class="text-xs"
            [class]="p.active ? 'text-green-600' : 'text-red-600'"
          >
            {{ p.active ? "Activo" : "Inactivo" }}
          </p>
        </div>

        <div class="flex gap-2">
          @if (editingId === p.id) {
            <div class="flex flex-col sm:flex-row gap-3 sm:gap-2 sm:items-end">
              <div class="w-full sm:w-32">
                <label
                  class="block text-xs font-semibold text-[#6E5C4B]"
                  [for]="'price-' + p.id"
                >
                  Precio
                </label>
                <input
                  [id]="'price-' + p.id"
                  type="number"
                  class="h-10 w-full px-2 border rounded"
                  [(ngModel)]="editPrice"
                />
              </div>

              <div class="w-full sm:w-32">
                <label
                  class="block text-xs font-semibold text-[#6E5C4B]"
                  [for]="'stock-' + p.id"
                >
                  Stock
                </label>
                <input
                  [id]="'stock-' + p.id"
                  type="number"
                  class="h-10 w-full px-2 border rounded"
                  [(ngModel)]="editStock"
                />
              </div>

              <button
                (click)="saveEdit(p)"
                class="h-10 w-full sm:w-auto px-4 bg-[#FFBF00] rounded-xl font-bold text-[#4B3621]"
              >
                Guardar
              </button>

              <button
                (click)="cancelEdit()"
                class="h-10 w-full sm:w-auto px-4 border rounded-xl"
              >
                Cancelar
              </button>
            </div>
          } @else {
            <button
              (click)="startEdit(p)"
              class="px-4 h-10 bg-[#4B3621] text-white rounded-xl"
            >
              Editar
            </button>

            @if (p.active) {
              <button
                (click)="deactivate(p)"
                class="px-4 h-10 bg-red-500 text-white rounded-xl"
              >
                Desactivar
              </button>
            } @else {
              <button
                (click)="activate(p)"
                class="px-4 h-10 bg-green-600 text-white rounded-xl"
              >
                Activar
              </button>
            }
          }
        </div>
      </div>
    }

    <!-- PAGINAS -->
    <div class="flex justify-between mt-4">
      <button (click)="prevPage()" class="px-4 py-2 border rounded">
        Anterior
      </button>

      <span>Página {{ page }} de {{ totalPages }}</span>

      <button (click)="nextPage()" class="px-4 py-2 border rounded">
        Siguiente
      </button>
    </div>
  }
</div>
